select(-"<NA>")
site.st <- left_join(site.st, site.st2, by = "自治体コード")
# NAを0に置換
site.st[is.na(site.st)] <- 0
# 水系リストを読み込み・結合
river <- import("13Tokyo_river.csv", setclass = "tbl_df", encoding="UTF-8")
site.stable <- site.st %>%
inner_join(river, by = "自治体コード") %>%
select("水系", "配列", "自治体コード", "名称", "合計", "旧石器", "縄文", "弥生", "古墳", "奈良", "平安", "中世", "近世", "時代不明")
# 表形式で表示
#自治体コードでソート、
# site.stable <- arrange(site.st, 自治体コード)
#河川水系でソート
site.stable <- arrange(site.stable, 配列)
#formattableで表出力
formattable(site.stable,list(合計=color_bar("tomato"),
旧石器=color_bar("blue"),
縄文=color_bar("brown"),
弥生=color_bar("orange"),
古墳=color_bar("green"),
奈良=color_bar("purple"),
平安=color_bar("yellow"),
中世=color_bar("pink"),
近世=color_bar("skyblue"),
時代不明=color_bar("lightgrey")))
#集計2:遺跡種別
# 列名整理
site.total2 <- rename(site.total, "遺構" = "主な遺構/概要")
# ベースリスト
site.sp <- select(site.st,自治体コード,区市町村名)
# 縄文貝塚
site.st2 <- site.total %>%
filter(str_detect(種別, "貝塚")) %>%
group_by(自治体コード)　%>%
tally %>%
rename("貝塚" = "n")
site.sp <- left_join(site.sp, site.st2, by = "自治体コード")
# 方形周溝墓
site.st2 <- site.total2 %>%
filter(str_detect(遺構,"方形周溝墓")) %>%
group_by(自治体コード) %>%
tally() %>%
rename("方形周溝墓" = "n")
site.sp <- left_join(site.sp, site.st2, by = "自治体コード")
# 古墳
site.st2 <- site.total %>%
filter(str_detect(種別,"古墳")) %>%
group_by(自治体コード) %>%
tally %>%
rename("古墳" = "n")
site.sp <- left_join(site.sp, site.st2, by = "自治体コード")
# 横穴墓
site.st2 <- site.total %>%
filter(str_detect(種別,"横穴墓")) %>%
group_by(自治体コード) %>%
tally %>%
rename("横穴墓" = "n")
site.sp <- left_join(site.sp, site.st2, by = "自治体コード")
# 社寺
site.st2 <- site.total %>%
filter(str_detect(種別,"社寺")) %>%
group_by(自治体コード) %>%
tally %>%
rename("社寺" = "n")
site.sp <- left_join(site.sp, site.st2, by = "自治体コード")
# 城跡
site.st2 <- site.total %>%
filter(str_detect(種別,"城館")) %>%
group_by(自治体コード) %>%
tally %>%
rename("城館" = "n")
site.sp <- left_join(site.sp, site.st2, by = "自治体コード")
# 塚
site.st2 <- site.total %>%
filter(str_detect(種別,"塚")) %>%
group_by(自治体コード) %>%
tally %>%
rename("塚" = "n")
site.sp <- left_join(site.sp, site.st2, by = "自治体コード")
# NAを0に置換
site.sp[is.na(site.sp)] <- 0
# 水系リストを読み込み・結合
river <- import("13Tokyo_river.csv", setclass = "tbl_df", encoding="UTF-8")
site.sp <- site.sp %>%
inner_join(river, by = "自治体コード") %>%
select("水系", "配列", "自治体コード", "名称", "貝塚", "方形周溝墓", "古墳", "横穴墓", "社寺", "城館", "塚")
#自治体コードでソート、表形式で表示
# site.sp <- arrange(site.sp, 自治体コード)
#河川水系でソート
site.sp <- arrange(site.sp, 配列)
#formattableで表出力
formattable(site.sp,list(貝塚=color_bar("blue"),
方形周溝墓=color_bar("orange"),
古墳=color_bar("green"),
社寺=color_bar("yellow"),
城館=color_bar("red"),
塚=color_bar("purple"),
横穴墓=color_bar("brown")
)
)
write.csv(site.total, "13Tokyo_total.csv", row.names = FALSE) #UTF-8書き出し, ファイル名を適宜指定(全レコード)
write.csv(site.st, "13Tokyo_summary.csv", row.names = FALSE) #集計データ書き出し
write.csv(site.sp, "13Tokyo_sitetype.csv", row.names =FALSE) #集計データ(種別)書き出し
#時代別データ書き出し
write.csv(site.palaeolithic, "13Tokyo_total_palaeolithic.csv", row.names=FALSE)
write.csv(site.jomon, "13Tokyo_total_jomon.csv", row.names=FALSE)
write.csv(site.yayoi, "13Tokyo_total_yayoi.csv", row.names=FALSE)
write.csv(site.kofun, "13Tokyo_total_kofun.csv", row.names=FALSE)
write.csv(site.nara, "13Tokyo_total_nara.csv", row.names=FALSE)
write.csv(site.heian, "13Tokyo_total_heian.csv", row.names=FALSE)
write.csv(site.medieval, "13Tokyo_total_medieval.csv", row.names=FALSE)
write.csv(site.earlymodern, "13Tokyo_total_earlymodern.csv", row.names=FALSE)
write.csv(site.unknown, "13Tokyo_total_unknown.csv", row.names=FALSE)
site.total.coord <- drop_na(site.total,経度)
write.csv(site.total.coord, "13Tokyo_totalcoordSJS.csv", row.names = FALSE, fileEncoding = "CP932")　#Shift-JIS書き出し, ファイル名を適宜指定(全レコード)
#時代別データ書き出し
site.palaeolithic <- drop_na(site.palaeolithic,経度)
write.csv(site.palaeolithic, "13Tokyo_total_palaeolithicSJS.csv", row.names=FALSE, fileEncoding = "CP932")
site.jomon <- drop_na(site.jomon,経度)
write.csv(site.jomon, "13Tokyo_total_jomonSJS.csv", row.names=FALSE, fileEncoding = "CP932")
site.yayoi<- drop_na(site.yayoi,経度)
write.csv(site.yayoi, "13Tokyo_total_yayoiSJS.csv", row.names=FALSE, fileEncoding = "CP932")
site.kofun <- drop_na(site.kofun,経度)
write.csv(site.kofun, "13Tokyo_total_kofunSJS.csv", row.names=FALSE, fileEncoding = "CP932")
site.nara <- drop_na(site.nara,経度)
write.csv(site.nara, "13Tokyo_total_naraSJS.csv", row.names=FALSE, fileEncoding = "CP932")
site.heian <- drop_na(site.heian,経度)
write.csv(site.heian, "13Tokyo_total_heianSJS.csv", row.names=FALSE, fileEncoding = "CP932")
site.medieval <- drop_na(site.medieval,経度)
write.csv(site.medieval, "13Tokyo_total_medievalSJS.csv", row.names=FALSE, fileEncoding = "CP932")
site.earlymodern <- drop_na(site.earlymodern,経度)
write.csv(site.earlymodern, "13Tokyo_total_earlymodernSJS.csv", row.names=FALSE, fileEncoding = "CP932")
site.unknown <- drop_na(site.unknown,経度)
write.csv(site.unknown, "13Tokyo_total_unknownSJS.csv", row.names=FALSE, fileEncoding = "CP932")
site.n<-filter(site.total,自治体コード==13109)
View(site.n)
write.csv(site.n, "13109_Shinagawa-ku_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13111)
write.csv(site.n, "13109_Ota-ku_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13110)
write.csv(site.n, "13110_Megro-ku_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13203)
write.csv(site.n, "13203_Musashino-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13206)
write.csv(site.n, "13206_Fuchu-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13207)
write.csv(site.n, "13207_Akishima-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13208)
write.csv(site.n, "13208_Chofu-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13210)
write.csv(site.n, "13210_Koganei-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13211)
write.csv(site.n, "13211_Kodaira-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13212)
write.csv(site.n, "13212_Hino-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13214)
write.csv(site.n, "13214_Kokubunji-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13215)
write.csv(site.n, "13215_Kunitachi-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13218)
write.csv(site.n, "13218_Fussa-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13219)
write.csv(site.n, "13219_Komae-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13227)
write.csv(site.n, "13227_Hamura-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13229)
write.csv(site.n, "13229_Nishitokyo-shi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13303)
write.csv(site.n, "13303_Mizuho-machi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
site.n<-filter(site.total,自治体コード==13308)
write.csv(site.n, "13308_Okutama-machi_total.csv", row.names=FALSE, fileEncoding = "UTF-8")
CsvList <- list.files(pattern = "csv") # ファイル形式がcsvであるファイルの一覧をCsvListに収納
length(CsvList) #ファイルの数を確認
head(CsvList) # 最初の数行だけ表示する場合
# CsvList #確認(すべてのファイル名が表示されるので数が多い場合は注意)
#ラベル・テンプレートの読み込み
LabelTemplate = import("ListLabel_template.csv", encoding = "UTF-8")
site.total.age <- site.total %>%
select(JASID,自治体コード,遺跡名,緯度,経度) %>%
left_join(select(site.palaeolithic,JASID,旧石器時代),by = "JASID") %>%
left_join(select(site.jomon,JASID,縄文時代),by = "JASID") %>%
left_join(select(site.yayoi,JASID,弥生時代),by = "JASID") %>%
left_join(select(site.kofun,JASID,古墳時代),by = "JASID") %>%
left_join(select(site.nara,JASID,奈良時代),by = "JASID") %>%
left_join(select(site.heian,JASID,平安時代),by = "JASID") %>%
left_join(select(site.medieval,JASID,中世),by = "JASID") %>%
left_join(select(site.earlymodern,JASID,近世),by = "JASID") %>%
left_join(select(site.unknown,JASID,時代不明),by = "JASID")
write.csv(site.total.age, "13Tokyo_totalAge.csv", row.names = FALSE, fileEncoding = "UTF-8")
colnames(site.subtotal)
site.total.age2[is.na(site.total.age)] <- 0
site.total.age2<-[is.na(site.total.age)] <- 0
site.total.age2<-site.total.age[is.na(site.total.age)] <- 0
View(site.total.age)
site.total.age2<-site.total.age
site.total.age2[is.na(site.total.age)] <- 0
View(site.total.age2)
site.total.age2<-mutate_all(site.total.age,funs(ifelse(is.na(.),0,.)))
View(site.total.age2)
rm(site.total.age2)
site.total.age<-mutate_all(site.total.age,funs(ifelse(is.na(.),0,.)))
write.csv(site.total.age, "13Tokyo_totalAge.csv", row.names = FALSE, fileEncoding = "UTF-8")
View(site.total)
site.n<- filter(site.subtotal,自治体コード==13204)
View(site.n)
site.n<- filter(site.subtotal,"自治体コード"==13204)
site.n<- filter(site.subtotal,"自治体コード",13204)
site.n<- filter(site.subtotal,自治体コード==13204)
site.n<- filter(site.subtotal,自治体コード=13204)
site.n<- filter(site.subtotal,"自治体コード"=13204)
site.n<- filter(site.subtotal,"自治体コード"==13204)
site.n<- filter(site.subtotal, 自治体コード == 13204)
View(site.subtotal)
site.n<- filter(site.total, 自治体コード == 13204)
write.csv(site.n,"13204_Mitaka-shi_total.csv", row.names = FALSE, fileEncoding = "UTF-8")
View(site.jomon)
View(site.jomon)
site.st2 <- site.jomon %>%
filter(str_detect(時代, "草創期～晩期")) %>%
mutate(草創期=1, 早期=1, 前期=1, 中期=1, 後期=1, 晩期=1)
site.st2 <- site.jomon %>%
filter(str_detect(時代, "草創期～後期")) %>%
mutate(草創期=1, 早期=1, 前期=1, 中期=1, 後期=1)
View(site.st2)
site.st2 <- site.jomon %>%
filter(str_detect(時代, "草創期～晩期")) %>%
mutate(草創期=1, 早期=1, 前期=1, 中期=1, 後期=1, 晩期=1)
site.J2 <- left_join(site.J2, site.st2, by = "JASID")
site.J2 <- site.jomon
#  時期
site.st2 <- site.jomon %>%
filter(str_detect(時代, "草創期～晩期")) %>%
mutate(草創期=1, 早期=1, 前期=1, 中期=1, 後期=1, 晩期=1)
site.J2 <- left_join(site.J2, site.st2, by = "JASID")
site.st2 <- site.jomon %>%
filter(str_detect(時代, "草創期～後期")) %>%
mutate(草創期=1, 早期=1, 前期=1, 中期=1, 後期=1)
site.J2 <- left_join(site.J2, site.st2, by = "JASID")
View(site.J2)
site.J2 <- site.jomon
#  時期
site.st2 <- site.jomon %>%
select(時代) %>%
filter(str_detect(時代, "草創期～晩期")) %>%
mutate(草創期=1, 早期=1, 前期=1, 中期=1, 後期=1, 晩期=1)
site.J2 <- left_join(site.J2, site.st2, by = "JASID")
site.J2 <- site.jomon
#  時期
site.st2 <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代, "草創期～晩期")) %>%
mutate(草創期=1, 早期=1, 前期=1, 中期=1, 後期=1, 晩期=1)
site.J2 <- left_join(site.J2, site.st2, by = "JASID")
site.st2 <- site.jomon %>%
select(時代) %>%
filter(str_detect(時代, "草創期～後期")) %>%
mutate(草創期=1, 早期=1, 前期=1, 中期=1, 後期=1)
site.J2 <- left_join(site.J2, site.st2, by = "JASID")
View(site.J2)
site.JIncp <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代, "草創期")) %>%
mutate(草創期=1)
# 早期
site.JI <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代, "早期"|"草創期～前期"|"草創期～中期"|"草創期～後期"|"草創期～晩期")) %>%
mutate(早期=1, 前期=1, 中期=1, 後期=1)
View(site.JIncp)
site.JI <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代 %in% c("早期","草創期～前期","草創期～中期","草創期～後期","草創期～晩期"))) %>%
mutate(早期=1)
site.JI <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"早期","草創期～前期","草創期～中期","草創期～後期","草創期～晩期")) %>%
mutate(早期=1)
site.JI <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"早期"|"草創期～前期"|"草創期～中期"|"草創期～後期"|"草創期～晩期")) %>%
mutate(早期=1)
site.JI <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,["早期"|"草創期～前期"|"草創期～中期"|"草創期～後期"|"草創期～晩期"])) %>%
site.JI <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"早期")|str_detect("草創期～前期")|str_detect("草創期～中期")|str_detect("草創期～後期")|str_detect("草創期～晩期")) %>%
mutate(早期=1)
site.JI <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"早期")|str_detect(時代,"草創期～前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")) %>%
mutate(早期=1)
View(site.JI)
site.JE <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～中期"|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期")) %>%
mutate(前期=1)
site.JE <- site.jomon %>%
site.JE <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～中期"|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期")) %>%
mutate(前期=1)
site.JE <- site.jomon %>%
site.JI <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"早期")|str_detect(時代,"草創期～前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")) %>%
mutate(早期=1)
site.JE <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～中期"|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期")) %>%
mutate(前期=1)
# 中期
site.JE <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期"|str_detect(時代,"前期～後期")|str_detect(時代,"前期～晩期")) %>%
mutate(中期=1)
site.JE <- site.jomon %>%
site.JIncp <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代, "草創期")) %>%
mutate(草創期=1)
# 早期
site.JI <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"早期")|str_detect(時代,"草創期～前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")) %>%
mutate(早期=1)
# 前期
site.JE <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～中期")|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期")) %>%
mutate(前期=1)
# 中期
site.JE <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期")|str_detect(時代,"前期～後期")|str_detect(時代,"前期～晩期")) %>%
mutate(中期=1)
View(site.JE)
site.JE <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～中期")|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期")) %>%
mutate(前期=1)
# 中期
site.JM <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期")|str_detect(時代,"前期～後期")|str_detect(時代,"前期～晩期")) %>%
mutate(中期=1)
View(site.JE)
# 後期
site.JL <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～晩期")|str_detect(時代,"前期～晩期")|str_detect(時代,"中期～晩期")) %>%
mutate(後期=1)
# 晩期
site.JF <- site.jomon %>%
select(JASID, 時代) %>%
filter(str_detect(時代,"早期")|str_detect(時代,"草創期～前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")) %>%
mutate(晩期=1)
# NAを0に置換
site.sp[is.na(site.sp)] <- 0
#統合
site.J2 <- site.total %>%
select(JASID,自治体コード,遺跡名,緯度,経度) %>%
left_join(select(site.JIncp,JASID,草創期),by = "JASID") %>%
left_join(select(site.JI,JASID,早期),by = "JASID") %>%
left_join(select(site.JE,JASID,前期),by = "JASID") %>%
left_join(select(site.JM,JASID,中期),by = "JASID") %>%
left_join(select(site.JL,JASID,後期),by = "JASID") %>%
left_join(select(site.JF,JASID,晩期),by = "JASID") %>%
site.J2<-mutate_all(site.J2,funs(ifelse(is.na(.),0,.)))
site.J2 <- site.total %>%
select(JASID, 自治体コード, 遺跡名, 緯度, 経度) %>%
left_join(select(site.JIncp,JASID,草創期),by = "JASID") %>%
left_join(select(site.JI,JASID,早期),by = "JASID") %>%
left_join(select(site.JE,JASID,前期),by = "JASID") %>%
left_join(select(site.JM,JASID,中期),by = "JASID") %>%
left_join(select(site.JL,JASID,後期),by = "JASID") %>%
left_join(select(site.JF,JASID,晩期),by = "JASID") %>%
site.J2 <- site.total %>%
select(JASID, 自治体コード, 遺跡名, 時代, 緯度, 経度) %>%
left_join(select(site.JIncp, JASID, 草創期),by = "JASID") %>%
left_join(select(site.JI, JASID, 早期),by = "JASID") %>%
left_join(select(site.JE, JASID, 前期),by = "JASID") %>%
left_join(select(site.JM, JASID, 中期),by = "JASID") %>%
left_join(select(site.JL, JASID, 後期),by = "JASID") %>%
left_join(select(site.JF, JASID, 晩期),by = "JASID") %>%
site.J2<-mutate_all(site.J2,funs(ifelse(is.na(.),0,.)))
site.J2 <- site.total %>%
select(JASID, 自治体コード, 遺跡名, 時代, 緯度, 経度) %>%
left_join(select(site.JIncp, JASID, 草創期),by = "JASID") %>%
left_join(select(site.JI, JASID, 早期),by = "JASID") %>%
left_join(select(site.JE, JASID, 前期),by = "JASID") %>%
left_join(select(site.JM, JASID, 中期),by = "JASID") %>%
left_join(select(site.JL, JASID, 後期),by = "JASID") %>%
left_join(select(site.JF, JASID, 晩期),by = "JASID")
site.J2<-mutate_all(site.J2,funs(ifelse(is.na(.),0,.)))
site.J2 <- filter(site.total.age, 縄文 ==1)
View(site.total.age)
site.J2 <- filter(site.total.age, 縄文時代 ==1)
site.J2 <- site.J2 %>%
select(JASID, 自治体コード, 遺跡名, 時代, 緯度, 経度) %>%
left_join(select(site.JIncp, JASID, 草創期),by = "JASID") %>%
left_join(select(site.JI, JASID, 早期),by = "JASID") %>%
left_join(select(site.JE, JASID, 前期),by = "JASID") %>%
left_join(select(site.JM, JASID, 中期),by = "JASID") %>%
left_join(select(site.JL, JASID, 後期),by = "JASID") %>%
left_join(select(site.JF, JASID, 晩期),by = "JASID")
View(site.total.age)
site.J2 <- filter(site.total.age, 縄文時代 ==1)
site.J2 <- left_join(site.J2,select(site.total, JASID, 時代), by ="JASID")
site.J2 <- site.J2 %>%
select(JASID, 自治体コード, 遺跡名, 時代, 緯度, 経度) %>%
left_join(select(site.JIncp, JASID, 草創期),by = "JASID") %>%
left_join(select(site.JI, JASID, 早期),by = "JASID") %>%
left_join(select(site.JE, JASID, 前期),by = "JASID") %>%
left_join(select(site.JM, JASID, 中期),by = "JASID") %>%
left_join(select(site.JL, JASID, 後期),by = "JASID") %>%
left_join(select(site.JF, JASID, 晩期),by = "JASID")
site.J2<-mutate_all(site.J2,funs(ifelse(is.na(.),0,.)))
View(site.J2)
write.csv(site.J2,"13Tokyo_total_jomonPeriod",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.J2,"13Tokyo_total_jomonPeriodSJS",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JIncp,"13Tokyo_total_jomonIncp",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.J2,"13Tokyo_total_jomonIncpSJS",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JI,"13Tokyo_total_jomonI",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JI,"13Tokyo_total_jomonISJS",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JE,"13Tokyo_total_jomonE",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JE,"13Tokyo_total_jomonESJS",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JM,"13Tokyo_total_jomonM",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JM,"13Tokyo_total_jomonMSJS",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JL,"13Tokyo_total_jomonL",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JL,"13Tokyo_total_jomonLSJS",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JF,"13Tokyo_total_jomonF",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JF,"13Tokyo_total_jomonFSJS",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.J2,"13Tokyo_total_jomonPeriod.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.J2,"13Tokyo_total_jomonPeriodSJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JIncp,"13Tokyo_total_jomonIncp.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.J2,"13Tokyo_total_jomonIncpSJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JI,"13Tokyo_total_jomonI.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JI,"13Tokyo_total_jomonISJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JE,"13Tokyo_total_jomonE.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JE,"13Tokyo_total_jomonESJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JM,"13Tokyo_total_jomonM.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JM,"13Tokyo_total_jomonMSJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JL,"13Tokyo_total_jomonL.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JL,"13Tokyo_total_jomonLSJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JF,"13Tokyo_total_jomonF.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JF,"13Tokyo_total_jomonFSJS.csv",row.names = FALSE, fileEncoding = "CP932")
View(site.J2)
#  草創期
site.JIncp <- site.jomon %>%
select(JASID, 時代, 経度, 緯度) %>%
filter(str_detect(時代, "草創期")) %>%
mutate(草創期=1)
# 早期
site.JI <- site.jomon %>%
select(JASID, 時代, 経度, 緯度) %>%
filter(str_detect(時代,"早期")|str_detect(時代,"草創期～前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")) %>%
mutate(早期=1)
# 前期
site.JE <- site.jomon %>%
select(JASID, 時代, 経度, 緯度) %>%
filter(str_detect(時代,"前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～中期")|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期")) %>%
mutate(前期=1)
# 中期
site.JM <- site.jomon %>%
select(JASID, 時代, 経度, 緯度) %>%
filter(str_detect(時代,"中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～後期")|str_detect(時代,"早期～晩期")|str_detect(時代,"前期～後期")|str_detect(時代,"前期～晩期")) %>%
mutate(中期=1)
# 後期
site.JL <- site.jomon %>%
select(JASID, 時代, 経度, 緯度) %>%
filter(str_detect(時代,"後期")|str_detect(時代,"草創期～晩期")|str_detect(時代,"早期～晩期")|str_detect(時代,"前期～晩期")|str_detect(時代,"中期～晩期")) %>%
mutate(後期=1)
# 晩期
site.JF <- site.jomon %>%
select(JASID, 時代, 経度, 緯度) %>%
filter(str_detect(時代,"早期")|str_detect(時代,"草創期～前期")|str_detect(時代,"草創期～中期")|str_detect(時代,"草創期～後期")|str_detect(時代,"草創期～晩期")) %>%
mutate(晩期=1)
# NAを0に置換
site.sp[is.na(site.sp)] <- 0
#統合
site.J2 <- filter(site.total.age, 縄文時代 ==1)
site.J2 <- left_join(site.J2,select(site.total, JASID, 時代), by ="JASID")
site.J2 <- site.J2 %>%
select(JASID, 自治体コード, 遺跡名, 時代, 緯度, 経度) %>%
left_join(select(site.JIncp, JASID, 草創期),by = "JASID") %>%
left_join(select(site.JI, JASID, 早期),by = "JASID") %>%
left_join(select(site.JE, JASID, 前期),by = "JASID") %>%
left_join(select(site.JM, JASID, 中期),by = "JASID") %>%
left_join(select(site.JL, JASID, 後期),by = "JASID") %>%
left_join(select(site.JF, JASID, 晩期),by = "JASID")
site.J2<-mutate_all(site.J2,funs(ifelse(is.na(.),0,.)))
#データ書き出し
write.csv(site.J2,"13Tokyo_total_jomonPeriod.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.J2,"13Tokyo_total_jomonPeriodSJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JIncp,"13Tokyo_total_jomonIncp.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.J2,"13Tokyo_total_jomonIncpSJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JI,"13Tokyo_total_jomonI.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JI,"13Tokyo_total_jomonISJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JE,"13Tokyo_total_jomonE.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JE,"13Tokyo_total_jomonESJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JM,"13Tokyo_total_jomonM.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JM,"13Tokyo_total_jomonMSJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JL,"13Tokyo_total_jomonL.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JL,"13Tokyo_total_jomonLSJS.csv",row.names = FALSE, fileEncoding = "CP932")
write.csv(site.JF,"13Tokyo_total_jomonF.csv",row.names = FALSE, fileEncoding = "UTF-8")
write.csv(site.JF,"13Tokyo_total_jomonFSJS.csv",row.names = FALSE, fileEncoding = "CP932")
View(site.jomon)
View(site.jomon)
site.n <- filter(site.total,自治体コード==13202)
View(site.n)
write.csv(site.n,"13202_Tachikawa-shi_total.csv",row.names = FALSE, fileEncoding = "UTF-8")
